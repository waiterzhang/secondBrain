# 2024.5.27周报

### 需求

1.日流量权益接入

* 和促销、前端对技术方案；
* 完成日流量权益开发工作，已完成提测。但由于产品需求变更，还在配合联调。

2.会员互通需求进入

* 会员互通设计方案设计（初版），和各方讨论该方案。
* 正在完成设计方案的详细版本，进度90%；

### 问题与解决：

* Q：C给到的数据中，日流量库存并非每天都有，对于没有的日期如何定义？谁来定义？

* A：对于不存在的日期，目前需要产品给到出定义。而兜底最好由源头来做，因此暂定SPA那边检查日期，并对不存在的日期进行填充。  
  其次，对于链路上各方的行为约定，应该从API给出，而非口头约定。
* Q：如何解决由于顺序依赖所导致的串行问题？（报价依赖于bk保存到促销的信息进行查询）
* A：将具体数据进一步拆分，在依赖数据中看是否能再拆分为必须依赖和非必须依赖。如果非必须依赖里面不存在串行关系，则该串行问题可以尝试分拆得以并行。

### 思考

我们做兜底/校验/监控的边界在哪里？什么情况下需要我们去校验/监控/兜底上游的数据呢？

* 重要、源头非booking的数据不适合去兜底。例如库存信息，booking只负责展示，此时兜底数据层的内容是不合适的。
* 监控/日志，在于监控业务信息，以及其他不可控的信息。而不应该去监控方案设计、代码编写阶段应该明确而未明确到位的问题。
* 何时校验？这个应该看整个链路的整体设计方案，每一个环节都校验，显然是冗余的。这个应该在设计的时候做好约定。  
  其次，我们是否应该相信上游给的数据？理论上来讲不应该，所以做法应该是什么？如果我们拿到数据之后都校验，岂不是太复杂？我想，应不应该校验首先要想一想校验之后我们能干什么？目前这个问题想不到一个比较好的答案。

如何进行

### 下周工作

* 继续完成会员互通的设计与开发；

* 发布日流量权益需求；
