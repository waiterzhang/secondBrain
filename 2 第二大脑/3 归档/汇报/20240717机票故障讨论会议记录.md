# 20240717机票故障讨论会议记录

本次会议讨论机票故，主要从时间（事前、事中、事后），内外部（内部、外部）两个维度讨论了今后如何避免相似问题，以及预防、改进措施。  
核心点：

* 问题代码不能上线；
* 别人发布完，接下来才能继续发，且发布完必须保证所有集群代码一致；
* 无论有无问题，都要做好发布周知。特别是有问题时，要阻断接下来的发布，并保证周知到人；
* 提高对于异常的敏感性，问题的责任意识，组内问题即我之问题；
* 发现问题，及时反馈，及时抛出。优先保证恢复线上，再来排查问题。排查故障时，分工合作。线上恢复不等于故障结束，做好清理工作；
* 严格执行，不要跳步，勿踩红线。实在搞不定，找军哥给支持；
* 对生产要有敬畏之心，尤其是自测自发，更不能放松警惕。

todo：

* 提测后qunit是否拦截找qa确认；
* 故障上报、排查、处理需要组织系统培训，每个人都实操一下；
* 内部测试引起的错误标红，以便快速确认影响；
* 自动化测试跑的太慢，需要改进；
* todo整理后，明后给出一版具体措施。

黄哲：

* 代码有问题不能发线上；
* 环境要发全发，不能只发个别集群；
* ddl快到了，感觉和自己改的没有关系，就跳过了，这是不规范的；
* 发布出现问题，当事人周知、确认问题，提示后面发布的人有风险；
* 保持对于异常的敏感性。（军哥补充）
* 发现问题要重视，不能不是我的就不管了。（军哥补充）。

李润杰：

* 线上代码和服务保持一致。
* 发布中途发现代码出问题，锁住/回滚，关键点在于让别人阻断。
* 发现线上问题，要和相关同学确认影响，并且保证确认到了结果。
* 多环境容易出现不一致的问题，必须全发。
* 在自己没有排查条件/排查不明白的情况下，尽快抛出去，扩大范围。
* 线上恢复不是终点，要看是否把所有遗留的东西都处理完了。

孙海鹏：

* 有问题不能让别人发布；
* 优先回滚，再查问题；
* 不光是订单下降，订单上涨该发就得发。

王笛：

* 提测后qunit不拦截，要找qa确认一下。
* 日常开发中存在时间紧张，放松警惕，不严格执行/申请跳步的情况。（军哥补充：时间不够，提出来）
* 上线之后，开关打开的时候也要做一个周知。（军哥补充：所有开关上线后，都要验证，保证新老流程都被验收过。开关打开/关闭都要线上测试没问题，要提醒产品验收）。

张威特：

* 对生产要有敬畏之心；
* 等前一个人发布完，再发布。可以考虑引用上一个人的“done”然后再写发布预告。（军哥补充：要确认发布完成，形式可以再讨论）

李建军：

* 排查故障，没有头绪把所有的监控过一遍。
* 排查故障，分工合作，每个人负责一部分。
* 自测自发，需要更加严谨，不能掉以轻心。（杰哥建议：不能只看pd，要看影响程度，重要改动得考虑让qa介入）；
* 如何提高敏感性。（哲哥补充：拿不准的可以先发到小群里面来；军哥补充：（加强对于业务的理解）
* booking系统问题不多，导致排查自身系统问题的能力不足。

  * 哲哥补充：todo：自动化跑的太慢了，促销分钟级跑完了。可以考虑找qa沟通一下改进。
  * 哲哥补充：todo：错误信息内部测试加红，快速判断影响范围。
  * 海鹏：发布加锁（异常情况下的操作），不熟练，todo：培训一下。
  * 军哥：todo整理完后，明后给出一版具体的意见。

我建议：

* 看到前面的人down了、后面的人确认down了。
* 对生产要有敬畏，线上有问题去支持联调。
* 开关没有执行到，危险后置的。开关打开的时候也要做一个周知。也要发到群里。

‍
